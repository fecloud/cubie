<!DOCTYPE html>
<html>
<head>
    <title>百度网盘同步</title>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport"
          content="width=device-width,initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui"/>
    <link rel="apple-touch-icon-precomposed" href="/img/screen_icon.png"/>
    <meta name="format-detection" content="telephone=no"/>
    <link rel="stylesheet" href="../css/com.css"/>
    <link rel="stylesheet" href="../css/status.css"/>
    <link rel="stylesheet" href="../css/switchery.min.css"/>
    <script type="text/javascript" src="../js/jquery-2.1.1.min.js"></script>
    <script type="text/javascript" src="../js/jquery.cookie.js"></script>
    <script type="text/javascript" src="../js/com.js"></script>
    <script type="text/javascript" src="../js/html5.js"></script>
    <script type="text/javascript" src="../js/switchery.min.js"></script>
    <style type="text/css">
        .content, .show-operate {
            /*color: #007aff;*/
        }

        .idown {
            margin-left: 5px;
            margin-top: -2px;
            height: 13px;
            margin-right: -5px;
            width: 11px;
            -moz-transform: rotate(-90deg);
            -webkit-transform: rotate(-90deg);
        }

        .list-item {
            cursor: pointer;
        }

        .box1 {
            line-height: 44px;
        }

		.txt-over {
			text-overflow: ellipsis; 
			overflow: hidden; 
			white-space: nowrap; 
		}
    </style>
    <script type="text/javascript">

        $(document).ready(function () {

            back_bind();

            var allow_download_switch = document.querySelector('.allow-download-switch');
            var allow_download = new Switchery(allow_download_switch);

            var allow_upload_switch = document.querySelector('.allow-upload-switch');
            var allow_upload = new Switchery(allow_upload_switch);


            $.ajax({url: "{0}{1}.php?action=status".format(bdfs_service, randomInt(), getToken()), success: function (data) {
                if (data && data.code == 200){
                    $("#bdfs_status").html("正常");
                } else {
					$("#bdfs_status").html("故障");
                    $("#bdfs_status").css('color','red');

				}
            }, error: function () {
				$("#bdfs_status").html("故障");
                $("#bdfs_status").css('color','red');
			}});
			
			client_env();

        });
		
		function client_env() {
			$.ajax({url: "{0}{1}.php?action=status_ment".format(bdfs_service, randomInt(), getToken()), success: function (data) {
                if (data && data.code == 200) {
                    var server_data = data.data;
					if (server_data.localfilelist) {
						$("#bdfs_localfilelist").html(server_data.localfilelist);
						var date = new Date(); 
						date.setTime(server_data.localfilelist_last);
						$("#bdfs_localfilelist_last").html(date.format("MM-dd hh:mm:ss"));
					}
					if (server_data.uploading) {
						if (server_data.uploading === false || server_data.uploading === "") {
							$("#bdfs_uploading").html("未上传");
						} else {
							 $("#bdfs_uploading").html("上传中");
							 $("#bdfs_uploading_name").html(server_data.uploading.path.substring(server_data.uploading.path.lastIndexOf('/') + 1));
							 $("#bdfs_uploading_length").html(renderSize(server_data.uploading.length));
							 $("#bdfs_upload_size").html(renderSize(server_data.upload_size));
						}
					}
					
					if (server_data.downloading) {
						if (server_data.downloading === false || server_data.downloading === "") {
							$("#bdfs_downloading").html("未下载");
						} else {
							 $("#bdfs_downloading").html("下载中");
							 $("#bdfs_downloading_name").html(server_data.downloading.path.substring(server_data.downloading.path.lastIndexOf('/') + 1));
							 $("#bdfs_downloading_length").html(renderSize(server_data.downloading.length));
							 $("#bdfs_download_size").html(renderSize(server_data.download_size));
						}
					}
				}
				setTimeout("client_env()",2000); 
            }, error: function () {
				setTimeout("client_env()",2000);
			}});	
		}

    </script>

</head>

<body>

<div id="page">

    <div id="header">

        <div class="btn back_btn">返回</div>
        <h1>百度网盘同步</h1>
        <div style=" width: 50px;height: 30px;"></div>

    </div>

    <ul class="list group">
         <li class="list-item">
            <a href="report.html" >
                <div class="box">
                    <div class="content">服务状态</div>
                    <div class="service_operate text_right" id="bdfs_status">...</div>
                </div>
            </a>
        </li>
        
    </ul>

    <ul class="list group">
         <li class="list-item">
            <div class="box">
                <div class="content">上传文件</div>
                <div class="service_operate text_right" id="bdfs_status"><input type="checkbox" class="allow-download-switch" id="allow-download"/></div>
            </div>
            
        </li>
        <li class="list-item">
            <div class="box">
                <div class="content">下载文件</div>
                <div class="service_operate text_right" id="bdfs_status"><input type="checkbox" class="allow-upload-switch" id="allow-upload"/></div>
            </div>
        </li>
    </ul>

    <ul id="upload" class="list group">
        <li class="list-item">
            <div class="box">
                <div class="content">正在上传</div>
                <div class="service_operate text_right" id="bdfs_uploading">...</div>
            </div>
        </li>
        <li class="list-item">
            <div class="box">
                <div class="content">文件名称</div>
                <div class="service_operate text_right content txt-over" id="bdfs_uploading_name">...</div>
            </div>
        </li>
        <li class="list-item">
            <div class="box">
                <div class="content">文件大小</div>
                <div class="service_operate text_right" id="bdfs_uploading_length">...</div>
            </div>
        </li>
		<li class="list-item">
            <div class="box">
                <div class="content">已上传</div>
                <div class="service_operate text_right" id="bdfs_upload_size">...</div>
            </div>
        </li>
    </ul>
	
	<ul id="download" class="list group">
        <li class="list-item">
            <div class="box">
                <div class="content">正在下载</div>
                <div class="service_operate text_right" id="bdfs_downloading">...</div>
            </div>
        </li>
        <li class="list-item">
            <div class="box">
                <div class="content">文件名称</div>
                <div class="service_operate text_right content txt-over" id="bdfs_downloading_name">...</div>
            </div>
        </li>
        <li class="list-item">
            <div class="box">
                <div class="content">文件大小</div>
                <div class="service_operate text_right" id="bdfs_downloading_length">...</div>
            </div>
        </li>
		<li class="list-item">
            <div class="box">
                <div class="content">已下载</div>
                <div class="service_operate text_right" id="bdfs_download_size">...</div>
            </div>
        </li>
    </ul>

</div>

</body>
</html>
